"use strict";(self.webpackChunkidentity_express_manager_ui=self.webpackChunkidentity_express_manager_ui||[]).push([[949],{949:(ri,M,l)=>{l.r(M),l.d(M,{EditUsersModule:()=>oi});var m=l(6895),g=l(8185),I=l(2979),V=l(5503),$=l(8783),W=l(8265),z=l(85),X=l(9650),tt=l(5785),et=l(4091),it=l(5971),nt=l(5084),p=l(9383),J=l(6876),at=l(5046),ot=l(8308),st=l(7364),S=l(8024),lt=l(5554),r=l(4006),F=l(2718),Q=l(4004),x=l(590),C=l(2976),_=l(160),t=l(4650),f=l(4961),k=l(146),O=l(4889),Z=l(1481),h=l(7185),Y=l(3570),E=l(7111),v=l(388),T=l(7696),rt=l(8163),b=l(7608),R=l(799),ct=l(7005),dt=l(274),U=l(4225),P=l(9658),j=l(3110);const pt=["editClaimsForm"],mt=["addClaimModal"],ut=["deleteClaimModal"];function _t(i,o){if(1&i&&(t.TgZ(0,"option",38)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=t.oxw(),a=e.$implicit;let s;t.Q6J("value",e.index),t.xp6(2),t.hij(" ",null!==(s=a.displayName)&&void 0!==s?s:a.name," ")}}function gt(i,o){if(1&i&&(t.ynx(0),t.YNc(1,_t,3,2,"option",37),t.BQk()),2&i){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!e.required&&"role"!=e.name&&"sub"!=e.name)}}function ft(i,o){if(1&i&&t._UZ(0,"input",45),2&i){const e=t.oxw(2);t.Q6J("appClaimRegex",e.selectedClaim.rule)}}function ht(i,o){1&i&&t._UZ(0,"input",46)}function vt(i,o){1&i&&(t.TgZ(0,"app-form-toggle",47),t._UZ(1,"input",48),t.qZA()),2&i&&t.Q6J("id","claimsFormInput")("isTraffic",!0)("isAlt",!1)}function Ct(i,o){1&i&&(t.ynx(0),t._UZ(1,"app-date-time",51),t.BQk())}function Zt(i,o){1&i&&(t.ynx(0),t._UZ(1,"app-date-time",52),t.BQk()),2&i&&(t.xp6(1),t.Q6J("displayType","date"))}function At(i,o){if(1&i&&(t.TgZ(0,"div",49),t.YNc(1,Ct,2,0,"ng-container",50),t.YNc(2,Zt,2,1,"ng-container",50),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf","birthdate"!=e.selectedClaim.name),t.xp6(1),t.Q6J("ngIf","birthdate"==e.selectedClaim.name)}}function xt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",53)(1,"app-enum-claim-type-input",54),t.NdJ("valueChanged",function(a){t.CHM(e);const s=t.oxw(2);return t.KtG(s.claimsForm.controls.value.setValue(a))}),t.qZA()()}if(2&i){const e=t.oxw(2);t.Q6J("id","value-for-"+e.selectedClaim.id),t.xp6(1),t.Q6J("id","claimsFormInput")("typeId",e.selectedClaim.id)("hostingModal","addClaimModal")("value",e.claimsForm.value.value)}}function Tt(i,o){if(1&i&&(t.TgZ(0,"p",55),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);let n;t.xp6(1),t.hij(" ",null!==(n=e.selectedClaim.ruleValidationFailureDescription)&&void 0!==n?n:""," ")}}function bt(i,o){if(1&i&&(t.TgZ(0,"app-form-row",14),t.YNc(1,ft,1,1,"input",39),t.YNc(2,ht,1,0,"input",40),t.YNc(3,vt,2,3,"app-form-toggle",41),t.YNc(4,At,3,2,"div",42),t.YNc(5,xt,2,5,"div",43),t.YNc(6,Tt,2,1,"p",44),t.qZA()),2&i){const e=t.oxw();t.Q6J("id","claimsFormInput")("label","Common.Value")("isLast",!0),t.xp6(1),t.Q6J("ngIf","String"==e.selectedClaim.valueType),t.xp6(1),t.Q6J("ngIf","Int"==e.selectedClaim.valueType),t.xp6(1),t.Q6J("ngIf","Boolean"==e.selectedClaim.valueType),t.xp6(1),t.Q6J("ngIf","DateTime"==e.selectedClaim.valueType),t.xp6(1),t.Q6J("ngIf","Enum"==e.selectedClaim.valueType),t.xp6(1),t.Q6J("ngIf",e.claimsForm.invalid&&e.claimsForm.dirty)}}function Ut(i,o){1&i&&(t.TgZ(0,"div",56)(1,"div"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"UserDetails.NoClaimsMessage")," "))}function wt(i,o){if(1&i&&(t.TgZ(0,"b"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.displayName)}}function yt(i,o){if(1&i&&(t.TgZ(0,"b"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.type)}}function qt(i,o){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",e.value," ")}}function Nt(i,o){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"standardDate"),t.qZA()),2&i){const e=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.value),"")}}function Dt(i,o){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"standardDateTime"),t.qZA()),2&i){const e=t.oxw(3).$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.value),"")}}function Lt(i,o){if(1&i&&(t.TgZ(0,"span"),t.YNc(1,Nt,3,3,"span",50),t.YNc(2,Dt,3,3,"span",50),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf","birthdate"==e.type),t.xp6(1),t.Q6J("ngIf","birthdate"!=e.type)}}function Mt(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.True")))}function It(i,o){1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"Common.False")))}function Jt(i,o){if(1&i&&(t.TgZ(0,"span"),t.YNc(1,Mt,3,3,"div",50),t.YNc(2,It,3,3,"div",50),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf","true"==e.value),t.xp6(1),t.Q6J("ngIf","false"==e.value)}}function St(i,o){1&i&&(t.TgZ(0,"span",66),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Common.Policy")," "))}function Ft(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",67),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.editClaim(a))}),t._UZ(2,"span",68),t.TgZ(3,"span",12),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"button",69),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,s=t.oxw(2);return t.KtG(s.delete(a))}),t._UZ(7,"span",11),t.TgZ(8,"span",12),t._uU(9),t.ALo(10,"translate"),t.qZA()()()}2&i&&(t.xp6(4),t.Oqu(t.lcZ(5,2,"Common.Edit")),t.xp6(5),t.Oqu(t.lcZ(10,4,"Common.Delete.Title")))}function Qt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"td")(2,"div",63),t.YNc(3,qt,2,1,"span",50),t.YNc(4,Lt,3,2,"span",50),t.YNc(5,Jt,3,2,"span",50),t.qZA()(),t.TgZ(6,"td"),t.YNc(7,St,3,3,"span",64),t.qZA(),t.TgZ(8,"td"),t.YNc(9,Ft,11,6,"div",65),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(3),t.Q6J("ngIf","DateTime"!=e.format&&"Boolean"!=e.format),t.xp6(1),t.Q6J("ngIf","DateTime"==e.format),t.xp6(1),t.Q6J("ngIf","Boolean"==e.format),t.xp6(2),t.Q6J("ngIf",n.isPolicyClaim(e)),t.xp6(2),t.Q6J("ngIf",!n.notAllowedToEditClaim(e))}}function kt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"input",77),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.value=a)}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit;t.Q6J("ngModel",e.value)("appClaimRegex",e.regex)}}function Ot(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"input",78),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.value=a)}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit;t.Q6J("ngModel",e.value)}}function Yt(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-date-time",80),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw(3).$implicit;return t.KtG(s.value=a)}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngModel",e.value)}}function Et(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-date-time",81),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw(3).$implicit;return t.KtG(s.value=a)}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw(3).$implicit;t.xp6(1),t.Q6J("ngModel",e.value)("displayType","date")}}function Rt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Yt,2,1,"ng-container",50),t.YNc(2,Et,2,2,"ng-container",50),t.TgZ(3,"span",79),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("ngIf","birthdate"!=e.type),t.xp6(1),t.Q6J("ngIf","birthdate"==e.type),t.xp6(2),t.hij(" ",t.lcZ(5,3,"Common.Dates.UTCWarning")," ")}}function Pt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"app-form-toggle",47)(1,"input",82),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.value=a?"true":"false")}),t.qZA()()}if(2&i){const e=t.oxw(2).$implicit;t.Q6J("id","claim-"+e.type)("isTraffic",!0)("isAlt",!1),t.xp6(1),t.Q6J("id","claim-"+e.type)("ngModel","true"==e.value)}}function jt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"span")(1,"app-enum-claim-type-input",83),t.NdJ("valueChanged",function(a){t.CHM(e);const s=t.oxw(2).$implicit;return t.KtG(s.value=a)}),t.qZA()()}if(2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("id","claimsFormInput")("typeId",e.typeId)("value",e.value)}}function Bt(i,o){if(1&i&&(t.TgZ(0,"span",55),t._uU(1),t.qZA()),2&i){const e=t.oxw(2).$implicit;let n;t.xp6(1),t.hij(" ",null!==(n=null==e?null:e.failureMessage)&&void 0!==n?n:""," ")}}function Gt(i,o){1&i&&(t.TgZ(0,"span",66),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Common.Policy")," "))}function Ht(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"td")(2,"form",null,70),t.YNc(4,kt,1,2,"input",71),t.YNc(5,Ot,1,1,"input",72),t.YNc(6,Rt,6,5,"div",50),t.YNc(7,Pt,2,5,"app-form-toggle",41),t.YNc(8,jt,2,3,"span",50),t.YNc(9,Bt,2,1,"span",44),t.qZA()(),t.TgZ(10,"td"),t.YNc(11,Gt,3,3,"span",64),t.qZA(),t.TgZ(12,"td")(13,"div",73)(14,"button",74),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.updateClaim(a))}),t._UZ(15,"span",75),t.TgZ(16,"span",12),t._uU(17),t.ALo(18,"translate"),t.qZA()(),t.TgZ(19,"button",76),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.cancelEdit(a))}),t._UZ(20,"span",11),t.TgZ(21,"span",12),t._uU(22),t.ALo(23,"translate"),t.qZA()()()(),t.BQk()}if(2&i){const e=t.MAs(3),n=t.oxw(),a=n.$implicit,s=n.index,c=t.oxw(2);let d,u;t.xp6(4),t.Q6J("ngIf","String"==a.format),t.xp6(1),t.Q6J("ngIf","Int"==a.format),t.xp6(1),t.Q6J("ngIf","DateTime"==a.format),t.xp6(1),t.Q6J("ngIf","Boolean"==a.format),t.xp6(1),t.Q6J("ngIf","Enum"==a.format),t.xp6(1),t.Q6J("ngIf",null!==(d=null==(d=e.form.get("claimValue"))?null:d.invalid)&&void 0!==d&&d),t.xp6(2),t.Q6J("ngIf",c.isPolicyClaim(a)),t.xp6(3),t.Q6J("disabled",c.notAllowedToEditClaim(a)||c.checkDisabled("Claim"+s)||null!==(u=null==(u=e.form.get("claimValue"))?null:u.invalid)&&void 0!==u&&u),t.xp6(3),t.Oqu(t.lcZ(18,10,"Common.Save")),t.xp6(5),t.Oqu(t.lcZ(23,12,"Common.Cancel"))}}const Kt=function(i){return{"disabled inactive":i}};function Vt(i,o){if(1&i&&(t.TgZ(0,"tr",62)(1,"td"),t.YNc(2,wt,2,1,"b",50),t.YNc(3,yt,2,1,"b",50),t.qZA(),t.YNc(4,Qt,10,5,"ng-container",50),t.YNc(5,Ht,24,14,"ng-container",50),t.qZA()),2&i){const e=o.$implicit,n=t.oxw(2);t.Q6J("ngClass",t.VKq(5,Kt,n.notAllowedToEditClaim(e))),t.xp6(2),t.Q6J("ngIf",e.displayName),t.xp6(1),t.Q6J("ngIf",!e.displayName),t.xp6(1),t.Q6J("ngIf",!e.editing),t.xp6(1),t.Q6J("ngIf",e.editing)}}function $t(i,o){if(1&i&&(t.TgZ(0,"table",57)(1,"thead")(2,"tr")(3,"th",58),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th",59)(10,"span",12),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"th",59)(14,"span",12),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.TgZ(17,"tbody",60),t.YNc(18,Vt,6,7,"tr",61),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.hij(" ",t.lcZ(5,5,"Common.Name")," "),t.xp6(3),t.hij(" ",t.lcZ(8,7,"Common.Value")," "),t.xp6(4),t.hij("",t.lcZ(12,9,"Common.Policy")," "),t.xp6(4),t.Oqu(t.lcZ(16,11,"Common.Actions")),t.xp6(3),t.Q6J("ngForOf",e.optionalClaims)}}function Wt(i,o){if(1&i&&t._UZ(0,"app-pager",84),2&i){const e=t.oxw();t.Q6J("totalResults",null==e.optionalClaims?null:e.optionalClaims.length)}}const B=function(){return{animated:!1,backdrop:"static"}};let zt=(()=>{class i{constructor(e,n,a,s,c,d,u,N,D,L){this.fb=e,this.userService=n,this.claimTypesService=a,this.translate=s,this.errorService=c,this.titleService=d,this.toastr=u,this.dialogService=N,this.apClaimsService=D,this.cdref=L,this.editing=!1,this.optionalClaims=[],this.requiredClaims=[],this.parser=new DOMParser}ngOnInit(){this.combinedObservable=this.claimTypesService.getClaimTypes(null,null,!0).pipe((0,F.V)(this.userService.getCachedUser()),(0,Q.U)(([e,n])=>({claimTypes:e,user:n})),(0,x.P)()).subscribe(e=>{this.claimTypes=e.claimTypes,this.user=e.user,this.claims=e.user.claims,this.sortClaims();const n=this.translate.instant("Users.Singular")+" "+this.user.username+" "+this.translate.instant("Nav.Additional Details")+" - "+C.de.SITE_TITLE;this.titleService.setTitle(n)}),this.claimsForm=this.fb.group({type:[""],value:[""]},r.kI.required)}deleteClaim(e){this.userService.deleteUserClaim(this.user.subject,e).subscribe(n=>{this.closeDeleteModal();const a=this.optionalClaims.indexOf(e);this.optionalClaims.splice(a,1);const s=this.translate.instant("Notifications.Saving Success Title"),c=this.translate.instant("Notifications.Saving Success Message");this.toastr.success(s,c),this.user.claims=this.optionalClaims.concat(this.requiredClaims),this.userService.userSubject.next(this.user)},n=>{401===n.status?this.toastr.warning(this.translate.instant("UserDetails.UnauthorizedWarningDelete"),this.translate.instant("Notifications.Unauthorized")):this.errorService.handleError(n)})}delete(e){this.toDelete=e,this.deleteClaimModal.show()}closeDeleteModal(){this.toDelete=null,this.deleteClaimModal.hide()}closeAddModal(){this.claimsForm.controls.value.setValue(null),this.claimsForm.markAsPristine(),this.addClaimModal.hide()}canDeactivate(){return!this.editing||!this.editClaimsForm.dirty||(this.dialogService.confirm(),this.dialogService.eventStream)}cancelEdit(e){e.value=e.oldValue,e.editing=!1,this.editing=!1}changeFormat(e){var n=this.claimTypes[e];this.claimsForm.controls.value.setValue(null),this.claimsForm.markAsPristine(),"Boolean"===n?.valueType&&this.claimsForm.controls.value.setValue(!1),this.selectedClaim=n,this.cdref.detectChanges()}editClaim(e){e.oldValue=e.value,e.editing=!0,this.editing=!0}addClaim(){"sub"!==this.selectedClaim.name&&(("Int"===this.selectedClaim.valueType||"Boolean"===this.selectedClaim.valueType)&&(this.claimsForm.value.value=this.claimsForm.value.value.toString()),this.currentClaim=this.claimsForm.value,this.currentClaim.type=this.selectedClaim.name,this.currentClaim.typeId=this.selectedClaim.id,this.currentClaim.format=this.selectedClaim.valueType,this.currentClaim.displayName=this.selectedClaim.displayName,this.currentClaim.regex=this.selectedClaim.rule,this.currentClaim.failureMessage=this.selectedClaim.ruleValidationFailureDescription,this.submitClaim(this.currentClaim),this.closeAddModal())}checkDisabled(e){return!(!this.editClaimsForm||!this.editClaimsForm.controls[e])&&this.editClaimsForm.controls[e].invalid}updateClaim(e){"DateTime"===e.format&&(e.value=e.value),"Int"===e.format&&(e.value=e.value.toString()),this.userService.updateUserClaim(this.user.subject,{oldClaimType:e.type,oldClaimValue:e.oldValue,newClaimType:e.type,newClaimValue:e.value}).subscribe(a=>{e.editing=!1;const s=this.translate.instant("Notifications.Saving Success Title"),c=this.translate.instant("Notifications.Saving Success Message");this.toastr.success(s,c),this.user.claims=this.optionalClaims.concat(this.requiredClaims),this.userService.userSubject.next(this.user),this.editing=!1},a=>{if(401===a.status)this.toastr.warning(this.translate.instant("UserDetails.UnauthorizedWarningEdit"),this.translate.instant("Notifications.Unauthorized"));else{const s={toastBody:this.translate.instant("Notifications.Saving Error Title"),toastTitle:this.translate.instant("Notifications.Saving Error Message")};(this.errorService.handleError(a,s)&_.s.Toast)!==_.s.Toast&&this.toastr.error(s.toastBody,s.toastTitle)}})}submitClaim(e){this.userService.addUserClaim(this.user.subject,e).subscribe(n=>{this.currentClaim.editing=!1,this.selectedClaim=void 0,this.optionalClaims.push(this.currentClaim),this.claimsForm.setValue({type:"",value:""});const a=this.translate.instant("Notifications.Saving Success Title"),s=this.translate.instant("Notifications.Saving Success Message");this.toastr.success(a,s),this.user.claims=this.optionalClaims.concat(this.requiredClaims),this.userService.userSubject.next(this.user)},n=>{if(401===n.status)this.toastr.warning(this.translate.instant("UserDetails.UnauthorizedWarning"),this.translate.instant("Notifications.Unauthorized"));else{const a={toastBody:this.translate.instant("Notifications.Saving Error Title"),toastTitle:this.translate.instant("Notifications.Saving Error Message")};(this.errorService.handleError(n,a)&_.s.Toast)!==_.s.Toast&&this.toastr.error(a.toastBody,a.toastTitle)}})}sortClaims(){for(const e of this.claims)for(const n of this.claimTypes)if(n.name===e.type){const a={format:n.valueType,type:e.type,typeId:n.id,displayName:n.displayName,value:e.value,editing:!1,required:n.required};n.rule&&(a.regex=n.rule,a.failureMessage=n.ruleValidationFailureDescription),n.required?this.requiredClaims.push(a):this.optionalClaims.push(a)}}notAllowedToEditClaim(e){return this.apClaimsService.notAllowedToEditClaim(e)}isPolicyClaim(e){return this.apClaimsService.isPolicyClaim(e)}getAllowedValues(e){const n=this.claimTypes.find(a=>a.name===e.type);return n&&n.allowedValues||[]}isClaimInValid(){var e=this.claimsForm.get("value");return!!e&&e.invalid}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.QS),t.Y36(f.K),t.Y36(k.M),t.Y36(p.sK),t.Y36(O.T),t.Y36(Z.Dx),t.Y36(h._W),t.Y36(Y.x),t.Y36(E.n),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-additional-details"]],viewQuery:function(e,n){if(1&e&&(t.Gf(pt,5),t.Gf(mt,7),t.Gf(ut,7)),2&e){let a;t.iGM(a=t.CRH())&&(n.editClaimsForm=a.first),t.iGM(a=t.CRH())&&(n.addClaimModal=a.first),t.iGM(a=t.CRH())&&(n.deleteClaimModal=a.first)}},decls:76,vars:51,consts:[["id","editUserClaims",1,"tw-container","tw-mx-auto"],[1,"cms"],["right",""],[1,"tw-btn-success",3,"click"],["bsModal","","id","addClaimModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],["addClaimModal","bs-modal"],[1,"modal-dialog"],[1,"modal-content",3,"formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"modal-close",3,"click"],["aria-hidden","true",1,"fas","fa-times"],[1,"sr-only"],[1,"modal-body","scrollbars"],[3,"id","label","isLast"],[1,"tw-form-select"],["formControlName","type","id","claimsFormDropdown",1,"tw-form-control",3,"change"],["disabled","","selected",""],[4,"ngFor","ngForOf"],[3,"id","label","isLast",4,"ngIf"],[1,"modal-body-fade"],[1,"modal-footer"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-auto"],["type","submit",1,"tw-btn-success",3,"disabled","click"],[1,"tw-btn-link","tw--mr-4",3,"click"],["class","tw-alert","role","alert",4,"ngIf"],["class","datatable hover",4,"ngIf"],["hidePager","true",3,"totalResults",4,"ngIf"],["bsModal","","id","deleteClaimModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],["deleteClaimModal","bs-modal"],[1,"modal-dialog","modal-dialog--danger"],[1,"modal-content"],[1,"modal-body","tw-text-center","scrollbars"],[1,"tw-mb-4"],[1,"tw-pill-danger",3,"innerHTML"],[1,"tw-btn-danger",3,"click"],[3,"value",4,"ngIf"],[3,"value"],["class","tw-form-control","formControlName","value","type","text","name","string","id","claimsFormInput","required","",3,"appClaimRegex",4,"ngIf"],["class","tw-form-control","formControlName","value","type","number","name","number","id","claimsFormInput","required","",4,"ngIf"],[3,"id","isTraffic","isAlt",4,"ngIf"],["class","tw-w-full sm:tw-max-w-2xl",4,"ngIf"],["class","",3,"id",4,"ngIf"],["class","tw-form-text-danger",4,"ngIf"],["formControlName","value","type","text","name","string","id","claimsFormInput","required","",1,"tw-form-control",3,"appClaimRegex"],["formControlName","value","type","number","name","number","id","claimsFormInput","required","",1,"tw-form-control"],[3,"id","isTraffic","isAlt"],["id","claimsFormInput","formControlName","value","type","checkbox","binary","true",1,"tw-form-switch__input"],[1,"tw-w-full","sm:tw-max-w-2xl"],[4,"ngIf"],["id","claimsFormInput","formControlName","value","required","true"],["id","claimsFormInput","formControlName","value","required","true",3,"displayType"],[1,"",3,"id"],[3,"id","typeId","hostingModal","value","valueChanged"],[1,"tw-form-text-danger"],["role","alert",1,"tw-alert"],[1,"datatable","hover"],[1,"tw-w-1/4"],[1,"tw-w-1"],["id","claimsTable"],["class","claim",3,"ngClass",4,"ngFor","ngForOf"],[1,"claim",3,"ngClass"],[1,"tw-truncate"],["class","tw-pill",4,"ngIf"],["class","tw-flex tw-items-center",4,"ngIf"],[1,"tw-pill"],["value","Edit",1,"tw-btn-link","tw-btn-small","tw-mr-1",3,"click"],["aria-hidden","true",1,"fad","fa-pencil"],["value","Delete",1,"tw-btn-link","tw-btn-small","tw-text-red-500",3,"click"],["editClaimsForm","ngForm"],["class","tw-form-control","type","text","name","claimValue","required","",3,"ngModel","appClaimRegex","ngModelChange",4,"ngIf"],["class","tw-form-control","type","number","name","claimValue","required","",3,"ngModel","ngModelChange",4,"ngIf"],[1,"tw-flex","tw-h-full"],["value","Save",1,"tw-btn-success","tw-mr-2",3,"disabled","click"],["aria-hidden","true",1,"fas","fa-check"],["value","CancelEdit",1,"tw-btn",3,"click"],["type","text","name","claimValue","required","",1,"tw-form-control",3,"ngModel","appClaimRegex","ngModelChange"],["type","number","name","claimValue","required","",1,"tw-form-control",3,"ngModel","ngModelChange"],[1,"tw-form-text"],["id","claimsFormInput","name","claimValue","required","true",3,"ngModel","ngModelChange"],["id","claimsFormInput","name","claimValue","required","true",3,"ngModel","displayType","ngModelChange"],["type","checkbox","name","claimValue",1,"tw-form-switch__input",3,"id","ngModel","ngModelChange"],["name","claimValue",3,"id","typeId","value","valueChanged"],["hidePager","true",3,"totalResults"]],template:function(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"p"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"app-action-bar"),t.ynx(6,2),t.TgZ(7,"button",3),t.NdJ("click",function(){t.CHM(a);const c=t.MAs(11);return t.KtG(c.show())}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.BQk(),t.qZA(),t.TgZ(10,"div",4,5)(12,"div",6)(13,"form",7)(14,"div",8)(15,"h5",9),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"button",10),t.NdJ("click",function(){return n.closeAddModal()}),t._UZ(19,"span",11),t.TgZ(20,"span",12),t._uU(21),t.ALo(22,"translate"),t.qZA()()(),t.TgZ(23,"div",13)(24,"app-form-row",14)(25,"div",15)(26,"select",16),t.NdJ("change",function(c){return n.changeFormat(c.target.value)}),t._UZ(27,"option",17),t.YNc(28,gt,2,1,"ng-container",18),t.qZA()()(),t.YNc(29,bt,7,9,"app-form-row",19),t.qZA(),t._UZ(30,"div",20),t.TgZ(31,"div",21)(32,"div",22)(33,"div",23)(34,"button",24),t.NdJ("click",function(){return n.addClaim()}),t._uU(35),t.ALo(36,"translate"),t.qZA()(),t.TgZ(37,"button",25),t.NdJ("click",function(){return n.closeAddModal()}),t._uU(38),t.ALo(39,"translate"),t.qZA()()()()()(),t.YNc(40,Ut,4,3,"div",26),t.YNc(41,$t,19,13,"table",27),t.YNc(42,Wt,1,1,"app-pager",28),t.qZA(),t.TgZ(43,"div",29,30)(45,"div",31)(46,"div",32)(47,"div",8)(48,"h5",9),t._uU(49),t.ALo(50,"translate"),t.qZA(),t.TgZ(51,"button",10),t.NdJ("click",function(){return n.closeDeleteModal()}),t._UZ(52,"span",11),t.TgZ(53,"span",12),t._uU(54),t.ALo(55,"translate"),t.qZA()()(),t.TgZ(56,"div",33)(57,"p",34),t._uU(58),t.ALo(59,"translate"),t.TgZ(60,"strong"),t._uU(61),t.qZA(),t._uU(62,"?"),t.qZA(),t._UZ(63,"p",35),t.ALo(64,"translate"),t.qZA(),t._UZ(65,"div",20),t.TgZ(66,"div",21)(67,"div",22)(68,"div",23)(69,"button",36),t.NdJ("click",function(){return n.deleteClaim(n.toDelete)}),t._uU(70),t.ALo(71,"translate"),t.qZA()(),t.TgZ(72,"button",25),t.NdJ("click",function(){return n.closeDeleteModal()}),t._uU(73),t.ALo(74,"translate"),t.qZA()()()()()(),t._UZ(75,"app-can-deactivate")}2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,25,"Users.Details.AdditionalDetailsBody")),t.xp6(5),t.hij(" ",t.lcZ(9,27,"Users.Details.AddClaim")," "),t.xp6(2),t.Q6J("config",t.DdM(49,B)),t.xp6(3),t.Q6J("formGroup",n.claimsForm),t.xp6(3),t.Oqu(t.lcZ(17,29,"Users.Details.AddClaim")),t.xp6(5),t.Oqu(t.lcZ(22,31,"Common.Close")),t.xp6(3),t.Q6J("id","claimsFormDropdown")("label","Common.Type")("isLast",!n.selectedClaim),t.xp6(4),t.Q6J("ngForOf",n.claimTypes),t.xp6(1),t.Q6J("ngIf",n.selectedClaim),t.xp6(5),t.Q6J("disabled",!n.claimsForm.valid||!n.selectedClaim),t.xp6(1),t.Oqu(t.lcZ(36,33,"Common.Add")),t.xp6(3),t.Oqu(t.lcZ(39,35,"Common.Cancel")),t.xp6(2),t.Q6J("ngIf",n.optionalClaims&&n.optionalClaims.length<=0),t.xp6(1),t.Q6J("ngIf",(null==n.optionalClaims?null:n.optionalClaims.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.optionalClaims?null:n.optionalClaims.length)>0),t.xp6(1),t.Q6J("config",t.DdM(50,B)),t.xp6(6),t.Oqu(t.lcZ(50,37,"Common.Delete.Confirm")),t.xp6(5),t.Oqu(t.lcZ(55,39,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(59,41,"Common.Delete.AreYouSure")," "),t.xp6(3),t.Oqu(null==n.toDelete?null:n.toDelete.type),t.xp6(2),t.Q6J("innerHTML",t.lcZ(64,43,"Common.Delete.Warning"),t.oJD),t.xp6(7),t.Oqu(t.lcZ(71,45,"Common.Delete.Title")),t.xp6(3),t.Oqu(t.lcZ(74,47,"Common.Delete.No")))},dependencies:[m.mk,m.sg,m.O5,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.Wl,r.EJ,r.JJ,r.JL,r.Q7,r.On,r.F,r.sg,r.u,v.oB,T.P,rt.K,b.L,R.O,ct.x,dt.V,U.j,P.J,p.X$,j.C9,j.g9],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),i})();var w=l(5698),G=l(5925),H=l(1216);function Xt(i,o){1&i&&t._UZ(0,"app-simple-loader")}function te(i,o){1&i&&(t.TgZ(0,"div",27)(1,"div"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"Users.Applications.None")))}function ee(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"tr",33)(1,"td",34),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.modalInfo(s))}),t.TgZ(2,"b"),t._uU(3),t.qZA()(),t.TgZ(4,"td",35),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.modalInfo(s))}),t._uU(5),t.qZA(),t.TgZ(6,"td")(7,"button",36),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.modalInfo(s))}),t._UZ(8,"span",37),t.TgZ(9,"span",15),t._uU(10),t.ALo(11,"translate"),t.qZA()()()()}if(2&i){const e=o.$implicit;t.xp6(3),t.Oqu(e.clientName),t.xp6(2),t.hij(" ",e.clientDescription," "),t.xp6(5),t.Oqu(t.lcZ(11,3,"Common.Info"))}}function ie(i,o){if(1&i&&(t.TgZ(0,"table",28)(1,"thead")(2,"tr")(3,"th"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th",29),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th",30)(10,"span",15),t._uU(11),t.ALo(12,"translate"),t.qZA()()()(),t.TgZ(13,"tbody",31),t.YNc(14,ee,12,5,"tr",32),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,4,"UserDetails.Name")),t.xp6(3),t.Oqu(t.lcZ(8,6,"Common.Description")),t.xp6(4),t.Oqu(t.lcZ(12,8,"Common.Actions")),t.xp6(3),t.Q6J("ngForOf",e.userApps)}}function ne(i,o){if(1&i&&t._UZ(0,"app-pager",38),2&i){const e=t.oxw();t.Q6J("totalResults",null==e.userApps?null:e.userApps.length)}}function ae(i,o){if(1&i&&t._UZ(0,"input",51),2&i){const e=t.oxw(2);t.Q6J("value",e.selectedApp.expires)}}function oe(i,o){1&i&&(t._UZ(0,"input",51),t.ALo(1,"translate")),2&i&&t.Q6J("value",t.lcZ(1,1,"Common.Never"))}function se(i,o){1&i&&(t.TgZ(0,"div",52)(1,"div",53),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"Users.Applications.DataEncrypted")))}function le(i,o){if(1&i&&(t.TgZ(0,"li",57)(1,"span",58),t._uU(2),t.qZA()()),2&i){const e=o.$implicit;t.xp6(2),t.Oqu(e)}}function re(i,o){if(1&i&&(t.TgZ(0,"dl")(1,"dt",54),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"dd")(5,"ul",55),t.YNc(6,le,3,1,"li",56),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"Users.Applications.Accessible")),t.xp6(4),t.Q6J("ngForOf",e.selectedApp.scopes)}}const ce=function(){return{backdrop:"static",animated:!1,keyboard:!0}};function de(i,o){if(1&i&&(t.TgZ(0,"div",39)(1,"div",40)(2,"div",10)(3,"div",11)(4,"h5",12),t._uU(5),t.qZA(),t.TgZ(6,"button",13),t._UZ(7,"span",14),t.TgZ(8,"span",15),t._uU(9),t.ALo(10,"translate"),t.qZA()()(),t.TgZ(11,"div",41)(12,"app-form-row",42),t._UZ(13,"input",43),t.qZA(),t.TgZ(14,"app-form-row",42),t._UZ(15,"input",44),t.qZA(),t.TgZ(16,"app-form-row",42)(17,"textarea",45),t._uU(18),t.qZA()(),t.TgZ(19,"app-form-row",42),t._UZ(20,"input",46),t.qZA(),t.TgZ(21,"app-form-row",42),t._UZ(22,"input",47),t.qZA(),t.TgZ(23,"app-form-row",42),t.YNc(24,ae,1,1,"input",48),t.YNc(25,oe,2,3,"input",48),t.qZA(),t.YNc(26,se,4,3,"div",49),t.YNc(27,re,7,4,"dl",2),t.qZA(),t.TgZ(28,"div",20)(29,"div",21)(30,"div",22)(31,"button",50),t._uU(32),t.ALo(33,"translate"),t.qZA()(),t.TgZ(34,"button",24),t._uU(35),t.ALo(36,"translate"),t.qZA()()()()()()),2&i){const e=t.oxw();t.Q6J("config",t.DdM(32,ce)),t.xp6(5),t.Oqu(e.selectedApp.clientName),t.xp6(4),t.Oqu(t.lcZ(10,26,"Common.Close")),t.xp6(3),t.Q6J("id","selectedAppName")("label","Common.Name"),t.xp6(1),t.Q6J("value",e.selectedApp.clientName),t.xp6(1),t.Q6J("id","selectedAppName")("label","Common.LogoURL"),t.xp6(1),t.Q6J("value",e.selectedApp.clientLogoUrl),t.xp6(1),t.Q6J("id","selectedAppDescription")("label","Common.Description"),t.xp6(2),t.Oqu(e.selectedApp.clientDescription),t.xp6(1),t.Q6J("id","selectedAppURL")("label","Common.URL"),t.xp6(1),t.Q6J("value",e.selectedApp.clientUrl),t.xp6(1),t.Q6J("id","selectedAppCreated")("label","Common.Created"),t.xp6(1),t.Q6J("value",e.selectedApp.created),t.xp6(1),t.Q6J("id","selectedAppExpires")("label","Common.Expires"),t.xp6(1),t.Q6J("ngIf",e.selectedApp.expires),t.xp6(1),t.Q6J("ngIf",!e.selectedApp.expires),t.xp6(1),t.Q6J("ngIf",e.selectedApp.scopes.length<1),t.xp6(1),t.Q6J("ngIf",(null==e.selectedApp?null:e.selectedApp.scopes.length)>0),t.xp6(5),t.Oqu(t.lcZ(33,28,"Users.Applications.Revoke")),t.xp6(3),t.Oqu(t.lcZ(36,30,"Common.Cancel"))}}const K=function(){return{backdrop:"static",animated:!1}};function pe(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",59)(1,"div",9)(2,"div",10)(3,"div",11)(4,"h5",12),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",13),t._UZ(8,"span",14),t.TgZ(9,"span",15),t._uU(10),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"div",16)(13,"p",17),t._uU(14),t.ALo(15,"translate"),t.TgZ(16,"strong"),t._uU(17),t.qZA(),t._uU(18),t.ALo(19,"translate"),t.TgZ(20,"strong"),t._uU(21),t.qZA(),t._uU(22,"."),t.qZA(),t.TgZ(23,"p"),t._uU(24),t.ALo(25,"translate"),t.qZA()(),t.TgZ(26,"div",20)(27,"div",21)(28,"div",22)(29,"button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.revokeSingle(a.selectedApp.clientId))}),t._uU(30),t.ALo(31,"translate"),t.qZA()(),t.TgZ(32,"button",60),t._uU(33),t.ALo(34,"translate"),t.qZA()()()()()()}if(2&i){const e=t.oxw();t.Q6J("config",t.DdM(24,K)),t.xp6(5),t.hij(" ",t.lcZ(6,10,"Users.Applications.RevokeApp")," "),t.xp6(5),t.Oqu(t.lcZ(11,12,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(15,14,"Users.Applications.RevokeUserConfirm")," "),t.xp6(3),t.Oqu(e.selectedApp.clientName),t.xp6(1),t.hij(" ",t.lcZ(19,16,"Users.Applications.ForUser")," "),t.xp6(3),t.Oqu(e.user.username),t.xp6(3),t.Oqu(t.lcZ(25,18,"Common.AreYouSureContinue")),t.xp6(6),t.hij(" ",t.lcZ(31,20,"Users.Applications.RevokeYes")," "),t.xp6(3),t.Oqu(t.lcZ(34,22,"Common.Cancel"))}}let me=(()=>{class i{constructor(e,n,a,s){this.titleService=e,this.userService=n,this.translate=a,this.toastr=s,this.isLoading=!0,this.isUnavailable=!1}ngOnInit(){this.userService.getCachedUser().pipe((0,w.q)(1)).subscribe(e=>{this.user=e,this.userService.getUserApps(this.user.subject).subscribe(n=>{this.userApps=n,this.isLoading=!1,this.isUnavailable=!1;const a=this.translate.instant("Users.Singular")+" "+this.user.username+" "+this.translate.instant("Nav.Applications")+" - "+C.de.SITE_TITLE;this.titleService.setTitle(a)},n=>{this.isLoading=!1})})}modalInfo(e){this.selectedApp=e}revokeAll(){this.userService.revokeAllUserApps(this.user.subject).subscribe(e=>{this.toastr.success(this.translate.instant("Notifications.AllAppsRevoked"),this.translate.instant("Notifications.Success")),this.userApps=[]},e=>{this.toastr.error(e,this.translate.instant("Notifications.Failure"))})}revokeSingle(e){this.userService.revokeSingleUserApp(this.user.subject,e).subscribe(n=>{this.toastr.success(this.translate.instant("Notifications.AppRevoked"),this.translate.instant("Notifications.Success"));const a=this.userApps.findIndex(s=>s.clientId===e);this.userApps.splice(a,1)},n=>{this.toastr.error(n,this.translate.instant("Notifications.Failure"))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Z.Dx),t.Y36(f.K),t.Y36(p.sK),t.Y36(h._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-applications"]],decls:45,vars:32,consts:[["id","editUserApplications",1,"tw-container","tw-mx-auto"],[1,"cms"],[4,"ngIf"],["class","tw-alert","role","alert",4,"ngIf"],["class","datatable selectable hover",4,"ngIf"],["hidePager","true",3,"totalResults",4,"ngIf"],["right",""],["data-toggle","modal","data-target","#revokeAllModal",1,"tw-btn-danger","tw-mb-3"],["id","revokeAllModal","bsModal","","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],[1,"modal-dialog","modal-dialog--danger"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"modal-close"],["aria-hidden","true",1,"fas","fa-times"],[1,"sr-only"],[1,"modal-body","tw-text-center","scrollbars"],[1,"tw-mb-4"],[1,"tw-pill-danger"],[1,"modal-body-fade"],[1,"modal-footer"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-auto"],["data-dismiss","modal",1,"tw-btn-danger",3,"click"],["data-dismiss","modal",1,"tw-btn-link","tw--mr-4"],["bsModal","","id","appInfoModal","class","modal","role","dialog","aria-hidden","true","tabindex","-1",3,"config",4,"ngIf"],["bsModal","","id","revokeAppModal","class","modal","role","dialog","aria-hidden","true","tabindex","-1",3,"config",4,"ngIf"],["role","alert",1,"tw-alert"],[1,"datatable","selectable","hover"],[1,"tw-hidden","md:tw-table-cell"],[1,"tw-w-1"],["id","userAppList"],["class","group",4,"ngFor","ngForOf"],[1,"group"],["data-toggle","modal","data-target","#appInfoModal",1,"tw-max-w-0","tw-truncate",3,"click"],["data-toggle","modal","data-target","#appInfoModal",1,"tw-hidden","tw-max-w-0","tw-truncate","md:tw-table-cell",3,"click"],["data-toggle","modal","data-target","#appInfoModal",1,"tw-btn-link","tw-btn-small","group-hover:tw-text-blue-500",3,"click"],["aria-hidden","true",1,"fad","fa-pencil"],["hidePager","true",3,"totalResults"],["bsModal","","id","appInfoModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],[1,"modal-dialog"],[1,"modal-body","scrollbars"],[3,"id","label"],["id","selectedAppName","readonly","",1,"tw-form-control",3,"value"],["id","selectedAppLogoUrl","readonly","",1,"tw-form-control",3,"value"],["id","selectedAppDescription","readonly","",1,"tw-form-control"],["id","selectedAppURL","readonly","",1,"tw-form-control",3,"value"],["id","selectedAppCreated","readonly","",1,"tw-form-control",3,"value"],["id","selectedAppExpires","class","tw-form-control","readonly","",3,"value",4,"ngIf"],["class","tw-alert-warning","role","alert",4,"ngIf"],["data-dismiss","modal","data-toggle","modal","data-target","#revokeAppModal",1,"tw-btn-danger"],["id","selectedAppExpires","readonly","",1,"tw-form-control",3,"value"],["role","alert",1,"tw-alert-warning"],["id","DataEncryptedWarning"],[1,"tw-font-semibold","tw-text-sm","tw-mb-2"],[1,"tw-flex","tw-flex-wrap","tw-item-start","tw--mt-2","tw--ml-2"],["class","tw-pt-2 tw-pl-2",4,"ngFor","ngForOf"],[1,"tw-pt-2","tw-pl-2"],[1,"tw-pill"],["bsModal","","id","revokeAppModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],["data-dismiss","modal","data-toggle","modal","data-target","#appInfoModal",1,"tw-btn-link","tw--mr-4"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"p"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,Xt,1,0,"app-simple-loader",2),t.YNc(6,te,4,3,"div",3),t.YNc(7,ie,15,10,"table",4),t.YNc(8,ne,1,1,"app-pager",5),t.qZA(),t.TgZ(9,"app-button-bar"),t.ynx(10,6),t.TgZ(11,"button",7),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.BQk(),t.qZA(),t.TgZ(14,"div",8)(15,"div",9)(16,"div",10)(17,"div",11)(18,"h5",12),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",13),t._UZ(22,"span",14),t.TgZ(23,"span",15),t._uU(24),t.ALo(25,"translate"),t.qZA()()(),t.TgZ(26,"div",16)(27,"p",17),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"p",18),t._uU(31),t.ALo(32,"translate"),t.qZA()(),t._UZ(33,"div",19),t.TgZ(34,"div",20)(35,"div",21)(36,"div",22)(37,"button",23),t.NdJ("click",function(){return n.revokeAll()}),t._uU(38),t.ALo(39,"translate"),t.qZA()(),t.TgZ(40,"button",24),t._uU(41),t.ALo(42,"translate"),t.qZA()()()()()(),t.YNc(43,de,37,33,"div",25),t.YNc(44,pe,35,25,"div",26)),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,15,"Users.Applications.Access")),t.xp6(2),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngIf",0==(null==n.userApps?null:n.userApps.length)&&!n.isLoading),t.xp6(1),t.Q6J("ngIf",(null==n.userApps?null:n.userApps.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.userApps?null:n.userApps.length)>0&&!n.isLoading),t.xp6(4),t.hij(" ",t.lcZ(13,17,"Users.Applications.RevokeAll")," "),t.xp6(2),t.Q6J("config",t.DdM(31,K)),t.xp6(5),t.Oqu(t.lcZ(20,19,"Users.Applications.RevokeAll")),t.xp6(5),t.Oqu(t.lcZ(25,21,"Common.Close")),t.xp6(4),t.Oqu(t.lcZ(29,23,"Users.Applications.RevokeConfirm")),t.xp6(3),t.Oqu(t.lcZ(32,25,"Common.Delete.Warning")),t.xp6(7),t.Oqu(t.lcZ(39,27,"Users.Applications.RevokeAll")),t.xp6(3),t.Oqu(t.lcZ(42,29,"Users.Applications.DontRevokeAll")),t.xp6(2),t.Q6J("ngIf",n.selectedApp),t.xp6(1),t.Q6J("ngIf",n.selectedApp))},dependencies:[m.sg,m.O5,v.oB,T.P,G.w,b.L,H.N,p.X$],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),i})();var y=l(9537),q=l(8176),ue=l(365),_e=l(9655),ge=l(9881),fe=l(4234),he=l(2830),ve=l(6252);const Ce=["claimsComponent"];function Ze(i,o){1&i&&(t.TgZ(0,"app-form-row",36),t._UZ(1,"app-date-time",47),t.qZA()),2&i&&(t.Q6J("id","LockoutEnd")("label","Users.LockoutEnd"),t.xp6(1),t.Q6J("displayType","datetime"))}const Ae=function(i){return[i]};function xe(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"form",35)(1,"app-form-row",36)(2,"app-form-toggle",37),t._UZ(3,"input",38),t.qZA()(),t.TgZ(4,"app-form-row",36),t._UZ(5,"app-readonly",39),t.ALo(6,"readOnlyValue"),t.qZA(),t.TgZ(7,"app-form-row",40)(8,"input",41),t.NdJ("keyup",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.checkForPolicyUserForm("firstName","given_name",null==a.userForm.controls.firstName?null:a.userForm.controls.firstName.value))}),t.qZA()(),t.TgZ(9,"app-form-row",40)(10,"input",42),t.NdJ("keyup",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.checkForPolicyUserForm("lastName","family_name",null==a.userForm.controls.lastName?null:a.userForm.controls.lastName.value))}),t.qZA()(),t.TgZ(11,"app-form-row",40)(12,"input",43),t.NdJ("keyup",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.checkForPolicyUserForm("username","name",null==a.userForm.controls.username?null:a.userForm.controls.username.value))}),t.qZA()(),t.TgZ(13,"app-form-row",40)(14,"input",44),t.NdJ("keyup",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.checkForPolicyUserForm("email","email",null==a.userForm.controls.email?null:a.userForm.controls.email.value))}),t.qZA()(),t.TgZ(15,"app-form-row",36)(16,"app-form-toggle",37)(17,"input",45),t.NdJ("change",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearLockoutEnd())}),t.qZA()()(),t.YNc(18,Ze,2,3,"app-form-row",46),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("formGroup",e.userForm),t.xp6(1),t.Q6J("id","Blocked")("label","UserDetails.Active"),t.xp6(1),t.Q6J("id","Blocked")("isTraffic",!0)("isAlt",!0),t.xp6(2),t.Q6J("id","userId")("label","Common.ID"),t.xp6(1),t.Q6J("fieldType",e.ReadOnlyFieldType.Single)("values",t.VKq(30,Ae,t.lcZ(6,28,e.user.subject))),t.xp6(2),t.Q6J("id","FirstName")("label","Users.FirstName")("help",e.ifUserInfoPolicyClaim("given_name",null==e.userForm.controls.firstName?null:e.userForm.controls.firstName.value)?"Common.Policy":""),t.xp6(2),t.Q6J("id","LastName")("label","Users.LastName")("help",e.ifUserInfoPolicyClaim("family_name",null==e.userForm.controls.lastName?null:e.userForm.controls.lastName.value)?"Common.Policy":""),t.xp6(2),t.Q6J("id","Username")("label","Users.Username")("help",e.ifUserInfoPolicyClaim("name",null==e.userForm.controls.username?null:e.userForm.controls.username.value)?"Common.Policy":""),t.xp6(2),t.Q6J("id","Email")("label","Users.Email")("help",e.ifUserInfoPolicyClaim("email",null==e.userForm.controls.email?null:e.userForm.controls.email.value)?"Common.Policy":""),t.xp6(2),t.Q6J("id","LockoutEnabled")("label","Users.LockoutEnabled"),t.xp6(1),t.Q6J("id","LockoutEnabled")("isTraffic",!0)("isAlt",!1),t.xp6(2),t.Q6J("ngIf",null==e.userForm.controls.lockoutEnabled?null:e.userForm.controls.lockoutEnabled.value)}}function Te(i,o){if(1&i&&(t.TgZ(0,"form",35)(1,"app-form-row",48)(2,"app-form-toggle",37),t._UZ(3,"input",49),t.qZA()()()),2&i){const e=t.oxw();t.Q6J("formGroup",e.userForm),t.xp6(1),t.Q6J("id","EnabledTwoFactor")("label","UserDetails.EnabledTwoFactor")("help","UserDetails.EnabledTwoFactorHelp")("isLast",!0),t.xp6(1),t.Q6J("id","EnabledTwoFactor")("isTraffic",!0)("isAlt",!1)}}function be(i,o){1&i&&(t.TgZ(0,"button",50),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UserDetails.ChangePassword")," "))}function Ue(i,o){1&i&&(t.TgZ(0,"button",51),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UserDetails.ResetMfa")," "))}function we(i,o){1&i&&(t.TgZ(0,"button",52),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Common.Delete.Title")," "))}function ye(i,o){1&i&&(t.TgZ(0,"button",53),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Common.Delete.UndoDelete")," "))}function qe(i,o){1&i&&t._UZ(0,"span",57)}function Ne(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",54)(1,"div",13)(2,"h5",14),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",15),t._UZ(6,"span",16),t.TgZ(7,"span",17),t._uU(8),t.ALo(9,"translate"),t.qZA()()(),t.TgZ(10,"div",18)(11,"p"),t._uU(12),t.ALo(13,"translate"),t.TgZ(14,"strong"),t._uU(15),t.qZA(),t._uU(16,"?"),t.qZA()(),t.TgZ(17,"div",22)(18,"div",23)(19,"div",24)(20,"button",55),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.resetPassword())}),t._uU(21),t.ALo(22,"translate"),t.YNc(23,qe,1,0,"span",56),t.qZA()(),t.TgZ(24,"button",26),t._uU(25),t.ALo(26,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,8,"Common.ResetPassword.Confirm")),t.xp6(5),t.Oqu(t.lcZ(9,10,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(13,12,"Common.ResetPassword.AreYouSureSimple")," "),t.xp6(3),t.Oqu(null==e.user?null:e.user.username),t.xp6(5),t.Q6J("disabled",e.inFlight),t.xp6(1),t.hij(" ",t.lcZ(22,14,"Common.ResetPassword.Title")," "),t.xp6(2),t.Q6J("ngIf",e.inFlight),t.xp6(2),t.Oqu(t.lcZ(26,16,"Common.Cancel"))}}function De(i,o){1&i&&(t.TgZ(0,"div",58)(1,"div",13)(2,"h5",14),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",15),t._UZ(6,"span",16),t.TgZ(7,"span",17),t._uU(8),t.ALo(9,"translate"),t.qZA()()(),t.TgZ(10,"div",18)(11,"p"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",22)(15,"div",23)(16,"div",24)(17,"a",59),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"button",26),t._uU(21),t.ALo(22,"translate"),t.qZA()()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,5,"Common.ResetPassword.HowToSetupTitle")),t.xp6(5),t.Oqu(t.lcZ(9,7,"Common.Close")),t.xp6(4),t.Oqu(t.lcZ(13,9,"Common.ResetPassword.HowToSetup")),t.xp6(6),t.Oqu(t.lcZ(19,11,"LandingPage.Documentation")),t.xp6(3),t.Oqu(t.lcZ(22,13,"Common.Cancel")))}function Le(i,o){1&i&&t._UZ(0,"span",57)}function Me(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",60)(1,"div",13)(2,"h5",14),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",15),t._UZ(6,"span",16),t.TgZ(7,"span",17),t._uU(8),t.ALo(9,"translate"),t.qZA()()(),t.TgZ(10,"div",18)(11,"p"),t._uU(12),t.ALo(13,"translate"),t.TgZ(14,"strong"),t._uU(15),t.qZA(),t._uU(16,"?"),t.qZA()(),t.TgZ(17,"div",22)(18,"div",23)(19,"div",24)(20,"button",55),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.resetMfa())}),t._uU(21),t.ALo(22,"translate"),t.YNc(23,Le,1,0,"span",56),t.qZA()(),t.TgZ(24,"button",26),t._uU(25),t.ALo(26,"translate"),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,8,"Common.ResetMfa.Confirm")),t.xp6(5),t.Oqu(t.lcZ(9,10,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(13,12,"Common.ResetMfa.AreYouSureSimple")," "),t.xp6(3),t.Oqu(null==e.user?null:e.user.username),t.xp6(5),t.Q6J("disabled",e.inFlight),t.xp6(1),t.hij(" ",t.lcZ(22,14,"Common.ResetMfa.Title")," "),t.xp6(2),t.Q6J("ngIf",e.inFlight),t.xp6(2),t.Oqu(t.lcZ(26,16,"Common.Cancel"))}}function Ie(i,o){1&i&&(t.TgZ(0,"div",61)(1,"div",13)(2,"h5",14),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",15),t._UZ(6,"span",16),t.TgZ(7,"span",17),t._uU(8),t.ALo(9,"translate"),t.qZA()()(),t.TgZ(10,"div",18)(11,"p"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",22)(15,"div",23)(16,"div",24)(17,"a",59),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"button",26),t._uU(21),t.ALo(22,"translate"),t.qZA()()()()),2&i&&(t.xp6(3),t.Oqu(t.lcZ(4,5,"Common.ResetMfa.HowToSetupTitle")),t.xp6(5),t.Oqu(t.lcZ(9,7,"Common.Close")),t.xp6(4),t.Oqu(t.lcZ(13,9,"Common.ResetMfa.HowToSetup")),t.xp6(6),t.Oqu(t.lcZ(19,11,"LandingPage.Documentation")),t.xp6(3),t.Oqu(t.lcZ(22,13,"Common.Cancel")))}const A=function(){return{backdrop:"static",animated:!1}};let Je=(()=>{class i{constructor(e,n,a,s,c,d,u,N,D,L,si,li){this.fb=e,this.userService=n,this.errorService=a,this.router=s,this.translate=c,this.claimsService=d,this.dialogService=u,this.titleService=N,this.toastr=D,this.localize=L,this.configService=si,this.apClaimsService=li,this.isDeleting=!1,this.requiredCount=0,this.dateTimeDisplayType=U.V,this.inFlight=!1}get ReadOnlyFieldType(){return _e.O}ngOnInit(){this.combinedObservable=this.claimsService.getClaimTypes(null,null).pipe((0,F.V)(this.userService.getCachedUser()),(0,Q.U)(([e,n])=>({claimTypes:e,user:n})),(0,x.P)()).subscribe({next:e=>{this.user=e.user,this.claimTypes=e.claimTypes,this.createForms();const n=this.translate.instant("Users.Singular")+" "+this.user.username+" "+this.translate.instant("Nav.Details")+" - "+C.de.SITE_TITLE;this.titleService.setTitle(n)},error:e=>{this.errorService.handleError(e)}}),this.configService.getConfig(!0).pipe((0,w.q)(1)).subscribe(e=>{this.passwordWebhookSetup=e.resetPasswordConfigured,this.resetMfaWebhookSetup=e.resetMfaConfigured})}ngOnDestroy(){this.combinedObservable.unsubscribe()}createForms(){this.userForm=this.fb.group({subject:[this.user.subject,r.kI.required],username:[{value:this.user.username,disabled:this.notAllowedToEditUserInfo("name",this.user.username)},[r.kI.required,(0,q.Fd)()]],email:[{value:this.user.email,disabled:this.notAllowedToEditUserInfo("name",this.user.email)},[r.kI.required,ue.J]],firstName:[{value:this.user.firstName,disabled:this.notAllowedToEditUserInfo("given_name",this.user.firstName)},r.kI.required],lastName:[{value:this.user.lastName,disabled:this.notAllowedToEditUserInfo("family_name",this.user.lastName)},r.kI.required],isBlocked:[this.user.isBlocked,r.kI.required],lockoutEnd:[this.user.lockoutEnd],lockoutEnabled:[this.user.lockoutEnabled],isDeleted:[this.user.isDeleted],twoFactorEnabled:[this.user.twoFactorEnabled]})}canDeactivate(){return!!this.isDeleting||!this.claimsComponent.claimsForm.dirty&&!this.userForm.dirty||(this.dialogService.confirm(),this.dialogService.eventStream)}deleteUser(){this.userService.deleteUser(this.user).subscribe(e=>{this.isDeleting=!0;const n=this.localize.translateRoute("/users");this.router.navigate([n]);const a=this.translate.instant("Users.Delete.Confirmation").replace("{0}",this.user.username);this.toastr.success(a,this.translate.instant("Notifications.Saving Success Title"))},e=>{const n={toastBody:this.translate.instant("Notifications.Delete Error Title"),toastTitle:this.translate.instant("Notifications.Delete User Message")};(this.errorService.handleError(e,n)&_.s.Toast)!==_.s.Toast&&this.toastr.error(n.toastBody,n.toastTitle)})}unDeleteUser(){const e=JSON.parse(JSON.stringify(this.user));e.isDeleted=!1,this.userService.updateUser(e).subscribe(n=>{this.user=e,this.userService.userSubject.next(e);const a=this.translate.instant("Notifications.Saving Success Title"),s=this.translate.instant("Notifications.Saving Success Message");this.toastr.success(s,a)},n=>{this.errorService.handleError(n)})}submit(){const e=this.userForm.value,n=this.user.claims.slice();for(const s of n){const c=this.claimsComponent.requiredClaims.find(d=>s.type===d.type);c&&(s.value=c.value)}this.claimsComponent.requiredClaims.forEach(s=>{void 0===n.find(d=>d.type===s.type)&&n.push(s)});const a=Object.assign(e,{claims:n},{roles:this.user.roles});this.userService.updateUser(a).subscribe({next:s=>{this.userForm.controls.username.dirty&&(this.user.username=this.userForm.controls.username.value);const c=this.translate.instant("Notifications.Saving Success Title"),d=this.translate.instant("Notifications.Saving Success Message");this.toastr.success(d,c),this.userService.userSubject.next(a),this.userForm.markAsPristine(),this.userForm.markAsUntouched(),this.claimsComponent.claimsForm.form.markAsUntouched(),this.claimsComponent.claimsForm.form.markAsPristine()},error:s=>{this.errorService.handleError(s)}})}resetPassword(){this.inFlight=!0,this.userService.resetPassword(this.user.subject).subscribe(e=>{this.inFlight=!1;const n=this.translate.instant("Notifications.Saving Success Title"),a=this.translate.instant("Notifications.Reset Success Message");this.toastr.success(a,n)},e=>{this.inFlight=!1,this.errorService.handleError(e)})}resetMfa(){this.inFlight=!0,this.userService.resetMfa(this.user.subject).subscribe(e=>{this.inFlight=!1;const n=this.translate.instant("Notifications.Saving Success Title"),a=this.translate.instant("Notifications.Reset Success Message");this.toastr.success(a,n)},e=>{this.inFlight=!1,this.errorService.handleError(e)})}ifUserInfoPolicyClaim(e,n){const a=new y.o;return a.type=e,a.value=n,this.apClaimsService.isPolicyClaim(a)}notAllowedToEditUserInfo(e,n){const a=new y.o;return a.type=e,a.value=n,this.apClaimsService.notAllowedToEditClaim(a)}notAllowedToEditClaim(e){return this.apClaimsService.notAllowedToEditClaim(e)}getHelpTextString(e){return this.apClaimsService.isPolicyClaim(e)?"DateTime"==e.format?"Common.PolicyWithUTCNotice":"Common.Policy":"DateTime"==e.format?"Common.Dates.UTCWarning":""}checkForPolicyUserForm(e,n,a){const s=new y.o;s.type=n,s.value=a,this.apClaimsService.notAllowedToEditClaim(s)&&this.userForm.controls[e].setErrors({incorrect:!0})}getClaimType(e){return this.claimTypes.find(n=>n.name===e.type)}getAllowedValues(e){const n=this.claimTypes.find(a=>a.name===e.type);return n&&n.allowedValues||[]}clearLockoutEnd(){this.userForm.get("lockoutEnd").reset()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.QS),t.Y36(f.K),t.Y36(O.T),t.Y36(g.F0),t.Y36(p.sK),t.Y36(k.M),t.Y36(Y.x),t.Y36(Z.Dx),t.Y36(h._W),t.Y36(I.An),t.Y36(ge.E),t.Y36(E.n))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-details"]],viewQuery:function(e,n){if(1&e&&t.Gf(Ce,7),2&e){let a;t.iGM(a=t.CRH())&&(n.claimsComponent=a.first)}},decls:83,vars:59,consts:[["id","editUserDetails",1,"tw-container","tw-mx-auto"],[3,"formGroup",4,"ngIf"],["id","requiredClaimsComponent",3,"claimTypes","claims"],["claimsComponent",""],["id","submitBtn",1,"tw-btn-success","tw-mr-3","tw-mb-3",3,"disabled","click"],["class","tw-btn tw-mr-3 tw-mb-3","data-toggle","modal","data-target","#resetPasswordModal","id","resetPasswordButton","type","button",4,"ngIf"],["class","tw-btn tw-mr-3 tw-mb-3","data-toggle","modal","data-target","#resetMfaModal","id","resetMfaButton","type","button",4,"ngIf"],["right",""],["class","tw-btn-danger tw-mb-3","type","button","data-toggle","modal","data-target","#deleteUserModal",4,"ngIf"],["id","undoDelete","class","tw-btn-danger tw-mb-3","type","button","data-toggle","modal","data-target","#unDeleteUserModal",4,"ngIf"],["id","deleteUserModal","bsModal","","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],[1,"modal-dialog","modal-dialog--danger"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"modal-close"],["aria-hidden","true",1,"fas","fa-times"],[1,"sr-only"],[1,"modal-body","tw-text-center","scrollbars"],[1,"tw-mb-4"],[1,"tw-pill-warning"],[1,"modal-body-fade"],[1,"modal-footer"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-auto"],["data-dismiss","modal",1,"tw-btn-danger",3,"click"],["data-dismiss","modal",1,"tw-btn-link","tw--mr-4"],["id","unDeleteUserModal","bsModal","","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],["bsModal","","id","resetPasswordModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],[1,"modal-dialog","modal-dialog--narrow"],["id","passwordResetModal","class","modal-content",4,"ngIf"],["id","passwordResetHowToSetupModal","class","modal-content",4,"ngIf"],["bsModal","","id","resetMfaModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],["id","mfaResetModal","class","modal-content",4,"ngIf"],["id","mfaResetHowToSetupModal","class","modal-content",4,"ngIf"],[3,"formGroup"],[3,"id","label"],[3,"id","isTraffic","isAlt"],["id","Blocked","formControlName","isBlocked","type","checkbox",1,"tw-form-switch__input"],[3,"fieldType","values"],[3,"id","label","help"],["type","text","name","FirstName","id","FirstName","formControlName","firstName","required","",1,"tw-form-control",3,"keyup"],["type","text","name","LastName","id","LastName","formControlName","lastName","required","",1,"tw-form-control",3,"keyup"],["type","text","name","Username","id","Username","formControlName","username","required","",1,"tw-form-control",3,"keyup"],["type","email","name","Email","id","Email","formControlName","email","required","",1,"tw-form-control",3,"keyup"],["id","LockoutEnabled","formControlName","lockoutEnabled","type","checkbox",1,"tw-form-switch__input",3,"change"],[3,"id","label",4,"ngIf"],["id","LockoutEnd","name","lockoutEnd","formControlName","lockoutEnd","aria-describedby","toErrorLabel",3,"displayType"],[3,"id","label","help","isLast"],["id","EnabledTwoFactor","formControlName","twoFactorEnabled","type","checkbox",1,"tw-form-switch__input"],["data-toggle","modal","data-target","#resetPasswordModal","id","resetPasswordButton","type","button",1,"tw-btn","tw-mr-3","tw-mb-3"],["data-toggle","modal","data-target","#resetMfaModal","id","resetMfaButton","type","button",1,"tw-btn","tw-mr-3","tw-mb-3"],["type","button","data-toggle","modal","data-target","#deleteUserModal",1,"tw-btn-danger","tw-mb-3"],["id","undoDelete","type","button","data-toggle","modal","data-target","#unDeleteUserModal",1,"tw-btn-danger","tw-mb-3"],["id","passwordResetModal",1,"modal-content"],["data-dismiss","modal",1,"tw-btn-success",3,"disabled","click"],["class","fad fa-spinner-third fa-spin tw-text-secondary-500 tw-mr-2 tw-ml-2",4,"ngIf"],[1,"fad","fa-spinner-third","fa-spin","tw-text-secondary-500","tw-mr-2","tw-ml-2"],["id","passwordResetHowToSetupModal",1,"modal-content"],["href","documentation/Webhooks/webhooks.html","target","_blank",1,"tw-btn"],["id","mfaResetModal",1,"modal-content"],["id","mfaResetHowToSetupModal",1,"modal-content"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,xe,19,32,"form",1),t._UZ(2,"app-required-claims-form",2,3),t.YNc(4,Te,4,8,"form",1),t.qZA(),t.TgZ(5,"app-button-bar")(6,"button",4),t.NdJ("click",function(){return n.submit()}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.YNc(9,be,3,3,"button",5),t.YNc(10,Ue,3,3,"button",6),t.ynx(11,7),t.YNc(12,we,3,3,"button",8),t.YNc(13,ye,3,3,"button",9),t.BQk(),t.qZA(),t.TgZ(14,"div",10)(15,"div",11)(16,"div",12)(17,"div",13)(18,"h5",14),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",15),t._UZ(22,"span",16),t.TgZ(23,"span",17),t._uU(24),t.ALo(25,"translate"),t.qZA()()(),t.TgZ(26,"div",18)(27,"p",19),t._uU(28),t.ALo(29,"translate"),t.TgZ(30,"strong"),t._uU(31),t.qZA(),t._uU(32,"?"),t.qZA(),t.TgZ(33,"p",20),t._uU(34),t.ALo(35,"translate"),t.qZA()(),t._UZ(36,"div",21),t.TgZ(37,"div",22)(38,"div",23)(39,"div",24)(40,"button",25),t.NdJ("click",function(){return n.deleteUser()}),t._uU(41),t.ALo(42,"translate"),t.qZA()(),t.TgZ(43,"button",26),t._uU(44),t.ALo(45,"translate"),t.qZA()()()()()(),t.TgZ(46,"div",27)(47,"div",11)(48,"div",12)(49,"div",13)(50,"h5",14),t._uU(51),t.ALo(52,"translate"),t.qZA(),t.TgZ(53,"button",15),t._UZ(54,"span",16),t.TgZ(55,"span",17),t._uU(56),t.ALo(57,"translate"),t.qZA()()(),t.TgZ(58,"div",18)(59,"p"),t._uU(60),t.ALo(61,"translate"),t.TgZ(62,"strong"),t._uU(63),t.qZA(),t._uU(64,"?"),t.qZA()(),t.TgZ(65,"div",22)(66,"div",23)(67,"div",24)(68,"button",25),t.NdJ("click",function(){return n.unDeleteUser()}),t._uU(69),t.ALo(70,"translate"),t.qZA()(),t.TgZ(71,"button",26),t._uU(72),t.ALo(73,"translate"),t.qZA()()()()()(),t.TgZ(74,"div",28)(75,"div",29),t.YNc(76,Ne,27,18,"div",30),t.YNc(77,De,23,15,"div",31),t.qZA()(),t.TgZ(78,"div",32)(79,"div",29),t.YNc(80,Me,27,18,"div",33),t.YNc(81,Ie,23,15,"div",34),t.qZA()(),t._UZ(82,"app-can-deactivate")),2&e){const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.user),t.xp6(1),t.Q6J("claimTypes",n.claimTypes)("claims",null==n.user?null:n.user.claims),t.xp6(2),t.Q6J("ngIf",n.user),t.xp6(2),t.Q6J("disabled",(null==n.userForm?null:n.userForm.invalid)||!a.isFormValid()||(null==n.userForm?null:n.userForm.pristine)&&(null==a.claimsForm?null:a.claimsForm.form.pristine)),t.xp6(1),t.hij(" ",t.lcZ(8,31,"Common.Save")," "),t.xp6(2),t.Q6J("ngIf",!(null!=n.user&&n.user.isDeleted)),t.xp6(1),t.Q6J("ngIf",!(null!=n.user&&n.user.isDeleted)),t.xp6(2),t.Q6J("ngIf",!(null!=n.user&&n.user.isDeleted)),t.xp6(1),t.Q6J("ngIf",null==n.user?null:n.user.isDeleted),t.xp6(1),t.Q6J("config",t.DdM(55,A)),t.xp6(5),t.Oqu(t.lcZ(20,33,"Common.Delete.Confirm")),t.xp6(5),t.Oqu(t.lcZ(25,35,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(29,37,"Common.Delete.AreYouSureSimple")," "),t.xp6(3),t.Oqu(null==n.user?null:n.user.username),t.xp6(3),t.Oqu(t.lcZ(35,39,"Users.Delete.AuditingPurposes")),t.xp6(7),t.Oqu(t.lcZ(42,41,"Common.Delete.Title")),t.xp6(3),t.Oqu(t.lcZ(45,43,"Common.Delete.No")),t.xp6(2),t.Q6J("config",t.DdM(56,A)),t.xp6(5),t.Oqu(t.lcZ(52,45,"Common.Delete.UndoDelete")),t.xp6(5),t.Oqu(t.lcZ(57,47,"Common.Close")),t.xp6(4),t.hij("",t.lcZ(61,49,"Common.Delete.ConfirmUndoDelete")," "),t.xp6(3),t.Oqu(null==n.user?null:n.user.username),t.xp6(6),t.Oqu(t.lcZ(70,51,"Common.Delete.TitleUndo")),t.xp6(3),t.Oqu(t.lcZ(73,53,"Common.Cancel")),t.xp6(2),t.Q6J("config",t.DdM(57,A)),t.xp6(2),t.Q6J("ngIf",n.passwordWebhookSetup),t.xp6(1),t.Q6J("ngIf",!n.passwordWebhookSetup),t.xp6(1),t.Q6J("config",t.DdM(58,A)),t.xp6(2),t.Q6J("ngIf",n.resetMfaWebhookSetup),t.xp6(1),t.Q6J("ngIf",!n.resetMfaWebhookSetup)}},dependencies:[m.O5,r._Y,r.Fj,r.Wl,r.JJ,r.JL,r.Q7,r.sg,r.u,v.oB,b.L,R.O,fe.x,U.j,he.f,P.J,H.N,p.X$,ve.b],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),i})();function Se(i,o){1&i&&t._UZ(0,"app-simple-loader")}function Fe(i,o){1&i&&(t.TgZ(0,"div",6)(1,"div"),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"UserLogins.NoLogins")))}function Qe(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td",14)(2,"b"),t._uU(3),t.qZA()(),t.TgZ(4,"td",15),t._uU(5),t.qZA(),t.TgZ(6,"td",15),t._uU(7),t.qZA(),t.TgZ(8,"td")(9,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.modalInfo(s))}),t._UZ(10,"span",17),t.TgZ(11,"span",11),t._uU(12),t.ALo(13,"translate"),t.qZA()()()()}if(2&i){const e=o.$implicit;t.xp6(3),t.Oqu(e.providerDisplayName),t.xp6(2),t.Oqu(e.loginProvider),t.xp6(2),t.Oqu(e.providerKey),t.xp6(5),t.Oqu(t.lcZ(13,4,"Common.Revoke"))}}function ke(i,o){if(1&i&&(t.TgZ(0,"table",7)(1,"thead")(2,"tr")(3,"th",8),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th",9),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th",9),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"th",10)(13,"span",11),t._uU(14),t.ALo(15,"translate"),t.qZA()()()(),t.TgZ(16,"tbody",12),t.YNc(17,Qe,14,6,"tr",13),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,5,"UserLogins.ProviderDisplayName")),t.xp6(3),t.Oqu(t.lcZ(8,7,"UserLogins.LoginProvider")),t.xp6(3),t.Oqu(t.lcZ(11,9,"UserLogins.ProviderKey")),t.xp6(4),t.Oqu(t.lcZ(15,11,"Common.Actions")),t.xp6(3),t.Q6J("ngForOf",e.userLogins)}}function Oe(i,o){if(1&i&&t._UZ(0,"app-pager",18),2&i){const e=t.oxw();t.Q6J("totalResults",null==e.userLogins?null:e.userLogins.length)}}const Ye=function(){return{backdrop:"static",animated:!1}};function Ee(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"h5",23),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",24),t._UZ(8,"span",25),t.TgZ(9,"span",11),t._uU(10),t.ALo(11,"translate"),t.qZA()()(),t.TgZ(12,"div",26)(13,"p"),t._uU(14),t.ALo(15,"translate"),t.qZA()(),t._UZ(16,"div",27),t.TgZ(17,"div",28)(18,"div",29)(19,"div",30)(20,"button",31),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteLogin(a.selectedLogin))}),t._uU(21),t.ALo(22,"translate"),t.qZA()(),t.TgZ(23,"button",32),t._uU(24),t.ALo(25,"translate"),t.qZA()()()()()()}2&i&&(t.Q6J("config",t.DdM(16,Ye)),t.xp6(5),t.hij(" ",t.lcZ(6,6,"UserLogins.RevokeExternalLogin")," "),t.xp6(5),t.Oqu(t.lcZ(11,8,"Common.Close")),t.xp6(4),t.Oqu(t.lcZ(15,10,"UserLogins.RevokeLoginConfirmationText")),t.xp6(7),t.Oqu(t.lcZ(22,12,"Common.Revoke")),t.xp6(3),t.Oqu(t.lcZ(25,14,"Common.Cancel")))}let Re=(()=>{class i{constructor(e,n,a){this.userService=e,this.translate=n,this.toastr=a,this.userLogins=[],this.isLoading=!0}ngOnInit(){this.userService.getCachedUser().pipe((0,w.q)(1)).subscribe(e=>{this.user=e,this.userService.getUserLogins(this.user.subject).subscribe(n=>{this.userLogins=n,this.isLoading=!1})})}modalInfo(e){this.selectedLogin=e}deleteLogin(e){this.userService.revokeUserLogin(this.user.subject,e).subscribe(()=>{this.toastr.success("Login Revoked",this.translate.instant("Notifications.Success")),this.userLogins.splice(this.userLogins.indexOf(e),1)},n=>{this.toastr.error(n,this.translate.instant("Notifications.Failure"))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.K),t.Y36(p.sK),t.Y36(h._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-logins"]],decls:6,vars:5,consts:[[1,"tw-container","tw-mx-auto"],[4,"ngIf"],["class","tw-alert","role","alert",4,"ngIf"],["class","datatable hover",4,"ngIf"],["hidePager","true",3,"totalResults",4,"ngIf"],["bsModal","","id","revokeLoginModal","class","modal","role","dialog","aria-hidden","true","tabindex","-1",3,"config",4,"ngIf"],["role","alert",1,"tw-alert"],[1,"datatable","hover"],[1,"md:tw-w-1/4"],[1,"tw-hidden","md:tw-table-cell"],[1,"tw-w-1"],[1,"sr-only"],["id","userLoginsList"],[4,"ngFor","ngForOf"],[1,"tw-max-w-0","tw-truncate"],[1,"tw-hidden","tw-max-w-0","tw-truncate","md:tw-table-cell"],["value","Delete","data-dismiss","modal","data-toggle","modal","data-target","#revokeLoginModal",1,"tw-btn-link","tw-btn-small","tw-text-red-500",3,"click"],["aria-hidden","true",1,"fas","fa-plug"],["hidePager","true",3,"totalResults"],["bsModal","","id","revokeLoginModal","role","dialog","aria-hidden","true","tabindex","-1",1,"modal",3,"config"],[1,"modal-dialog","modal-dialog--danger"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal",1,"modal-close"],["aria-hidden","true",1,"fas","fa-times"],[1,"modal-body","tw-text-center","scrollbars"],[1,"modal-body-fade"],[1,"modal-footer"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-auto"],["data-dismiss","modal",1,"tw-btn-danger",3,"click"],["data-dismiss","modal","data-toggle","modal","data-target","#appInfoModal",1,"tw-btn-link","tw--mr-4"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Se,1,0,"app-simple-loader",1),t.YNc(2,Fe,4,3,"div",2),t.YNc(3,ke,18,13,"table",3),t.YNc(4,Oe,1,1,"app-pager",4),t.qZA(),t.YNc(5,Ee,26,17,"div",5)),2&e&&(t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngIf",0==(null==n.userLogins?null:n.userLogins.length)&&!n.isLoading),t.xp6(1),t.Q6J("ngIf",(null==n.userLogins?null:n.userLogins.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.userLogins?null:n.userLogins.length)>0),t.xp6(1),t.Q6J("ngIf",n.selectedLogin))},dependencies:[m.sg,m.O5,v.oB,T.P,G.w,p.X$],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),i})();var Pe=l(9841),je=l(9883),Be=l(1060),Ge=l(8098);const He=["RolePicker"],Ve=[{path:"",redirectTo:"details",pathMatch:"full"},{path:"details",component:Je,canDeactivate:[S.I]},{path:"roles",component:(()=>{class i{constructor(e,n,a,s,c,d){this.rolesService=e,this.userService=n,this.titleService=a,this.translate=s,this.toastr=c,this.securityService=d,this.availableRoles=[],this.assignedRoles=[],this.restrictedPolicies=[],this.roleSearchValue=""}ngOnInit(){this.combinedObservable=(0,Pe.a)([this.rolesService.getRoles(),this.userService.getCachedUser()]).pipe((0,x.P)()).subscribe(e=>{this.availableRoles=e[0],this.assignedRoles=e[1].roles,this.user=e[1],this.matchRoles();const n=this.translate.instant("Users.Singular")+" "+this.user.username+" "+this.translate.instant("Nav.Roles")+" - "+C.de.SITE_TITLE;this.titleService.setTitle(n)})}ngAfterViewInit(){this.rolePicker.assignedStream.subscribe(e=>{this.addRoles(e)}),this.rolePicker.unAssignedStream.subscribe(e=>{this.deleteRoles(e)})}ngOnDestroy(){this.combinedObservable.unsubscribe()}isPolicyRole(e){const n=this.securityService.policyClaims;for(let a=0;a<n.length;a++)if("role"===n[a].type&&n[a].value===e)return!0;return!1}matchRoles(){for(const e of this.assignedRoles)for(const n of this.availableRoles)n.name===e.name&&this.availableRoles.splice(this.availableRoles.indexOf(n),1)}addRoles(e){const n=e.map(a=>a.name);this.userService.addUserRoles(this.user.subject,n).subscribe(a=>{this.availableRoles=(0,q.mn)(this.availableRoles.slice(),e);const s=this.assignedRoles.slice();this.assignedRoles=s.concat(e),this.rolePicker.availableCount=0,this.user.roles=this.assignedRoles.slice(),this.userService.userSubject.next(this.user),this.toastr.success(this.translate.instant("Roles.Success"),this.translate.instant("Notifications.Success"))},a=>{401===a.status&&this.toastr.warning(this.translate.instant("Roles.AssignUnauthorized"),this.translate.instant("Notifications.Unauthorized"))})}deleteRoles(e){const n=e.map(a=>a.name);this.userService.deleteUserRoles(this.user.subject,n).subscribe(a=>{this.assignedRoles=(0,q.mn)(this.assignedRoles.slice(),e);const s=this.availableRoles.slice();this.availableRoles=s.concat(e),this.rolePicker.assignedCount=0,this.user.roles=this.assignedRoles.slice(),this.userService.userSubject.next(this.user),this.toastr.success(this.translate.instant("Roles.Success"),this.translate.instant("Notifications.Success"))},a=>{401===a.status&&this.toastr.warning(this.translate.instant("Roles.UnassignUnauthorized"),this.translate.instant("Notifications.Unauthorized"))})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(je.f),t.Y36(f.K),t.Y36(Z.Dx),t.Y36(p.sK),t.Y36(h._W),t.Y36(Be.I))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-roles"]],viewQuery:function(e,n){if(1&e&&t.Gf(He,7),2&e){let a;t.iGM(a=t.CRH())&&(n.rolePicker=a.first)}},decls:3,vars:5,consts:[["id","editUserRoles",1,"tw-container","tw-mx-auto"],[3,"assignedInput","availableInput","restrictedInput","assignedSearch","availableSearch"],["RolePicker",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"app-common-picker",1,2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("assignedInput",n.assignedRoles)("availableInput",n.availableRoles)("restrictedInput",n.restrictedPolicies)("assignedSearch",!1)("availableSearch",!0))},dependencies:[Ge.v],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),i})()},{path:"additionaldetails",component:zt,canDeactivate:[S.I]},{path:"applications",component:me},{path:"userlogins",component:Re},{path:"useraudits",component:lt.L,canActivate:[at.h,ot.u]},{path:"sessions",component:J.O,canActivate:[st.f]}];let $e=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.aw.forChild({extend:!0}),g.Bz.forChild(Ve),p.aw,g.Bz]}),i})();var We=l(7023),ze=l(6980),Xe=l(2320),ti=l(4022),ei=l(4362),ii=l(5898),ni=l(7770),ai=l(8002);let oi=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[$.L,z.e],imports:[$e,m.ez,r.u5,r.UX,v.zk,V.D,p.aw,W.j,Xe.z8,I.fQ,ei.l,nt.y,tt.U,ti.p,ni.t,it.s,X.I,ii.T,g.Bz,J.O,ai.Z,et.G,We._,ze.K,g.Bz]}),i})()}}]);