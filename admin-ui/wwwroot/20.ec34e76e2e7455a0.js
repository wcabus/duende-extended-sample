"use strict";(self.webpackChunkidentity_express_manager_ui=self.webpackChunkidentity_express_manager_ui||[]).push([[20],{6020:(ne,m,o)=>{o.r(m),o.d(m,{ViewRolesModule:()=>se});var g=o(9808),p=o(3075),h=o(3673),d=o(3234),c=o(4894),x=o(1041),R=o(9001),S=o(4425),C=o(5558),U=o(658),y=o(9835),T=o(1541),A=o(6757),V=o(5550),L=o(4989),b=o(1556),O=o(2140),P=o(5654),e=o(5e3),v=o(3522),z=o(2313),J=o(1101),M=o(9468);const f=function(s){return[s]};let N=(()=>{class s{constructor(t,a,r){this.rolesService=t,this.titleService=a,this.translate=r}ngOnInit(){this.getCachedRoleSubscription=this.rolesService.getCachedRole().subscribe(t=>{this.role=t,this.roleReadOnlyDictionary=new O.$(this.role);const a=this.translate.instant("Roles.Role")+" "+this.role.name+" - "+b.de.SITE_TITLE;this.titleService.setTitle(a)})}ngOnDestroy(){this.getCachedRoleSubscription.unsubscribe()}get ReadOnlyFieldType(){return P.O}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(v.f),e.Y36(z.Dx),e.Y36(c.sK))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-view-role-details"]],decls:6,vars:11,consts:[["id","viewRoleDetails",1,"tw-container","tw-mx-auto"],[3,"label"],[3,"values","fieldType"],[3,"label","isLast"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"form"),e.TgZ(2,"app-form-row",1),e._UZ(3,"app-readonly",2),e.qZA(),e.TgZ(4,"app-form-row",3),e._UZ(5,"app-readonly",2),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("label","Common.Name"),e.xp6(1),e.Q6J("values",e.VKq(7,f,a.roleReadOnlyDictionary.name))("fieldType",a.ReadOnlyFieldType.Single),e.xp6(1),e.Q6J("label","Common.Description")("isLast",!0),e.xp6(1),e.Q6J("values",e.VKq(9,f,a.roleReadOnlyDictionary.description))("fieldType",a.ReadOnlyFieldType.Single))},directives:[p._Y,p.JL,p.F,J.L,M.f],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),s})();var Z=o(7579),Y=o(590),w=o(4004),u=o(5683),F=o(8675),I=o(5577),Q=o(4825),D=o(5764),j=o(2290),E=o(6997),K=o(7611),H=o(2978),$=o(4769),G=o(7769);function q(s,i){if(1&s){const t=e.EpF();e.ynx(0,12),e.TgZ(1,"div",13),e.TgZ(2,"label",14),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"select",15),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw(2).pageSize=r})("change",function(){e.CHM(t);const r=e.oxw(2);return r.setPageLength(+r.pageSize)}),e.TgZ(6,"option",16),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"option",17),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"option",18),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&s){const t=e.oxw(2);e.xp6(3),e.AsE("",t.pageSize," ",e.lcZ(4,6,"Nav.PerPage"),""),e.xp6(2),e.Q6J("ngModel",t.pageSize),e.xp6(2),e.hij("25 ",e.lcZ(8,8,"Nav.PerPage"),""),e.xp6(3),e.hij("50 ",e.lcZ(11,10,"Nav.PerPage"),""),e.xp6(3),e.hij("100 ",e.lcZ(14,12,"Nav.PerPage"),"")}}function _(s,i){if(1&s&&(e.TgZ(0,"app-action-bar"),e.YNc(1,q,15,14,"ng-container",11),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.pagedResult?null:t.pagedResult.results.length)>0)}}function B(s,i){1&s&&e._UZ(0,"app-simple-loader")}function X(s,i){1&s&&(e.TgZ(0,"div",19),e.TgZ(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"Users.NoUsersFound")))}function W(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td",25),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(2).goToUser(l)}),e.TgZ(2,"b",26),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"td",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(2).goToUser(l)}),e._uU(5),e.qZA(),e.TgZ(6,"td",27),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(2).goToUser(l)}),e._uU(7),e.qZA(),e.qZA()}if(2&s){const t=i.$implicit;e.xp6(3),e.Oqu(t.username),e.xp6(2),e.hij(" ",t.firstName," "),e.xp6(2),e.hij(" ",t.lastName," ")}}function k(s,i){if(1&s&&(e.TgZ(0,"table",20),e.TgZ(1,"thead"),e.TgZ(2,"tr"),e.TgZ(3,"th",21),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"th",22),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"th",22),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"tbody",23),e.YNc(13,W,8,3,"tr",24),e.qZA(),e.qZA()),2&s){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,4,"Users.Username")),e.xp6(3),e.Oqu(e.lcZ(8,6,"Users.FirstName")),e.xp6(3),e.Oqu(e.lcZ(11,8,"Users.LastName")),e.xp6(3),e.Q6J("ngForOf",t.users)}}function ee(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"app-pager",28),e.NdJ("onGoToPage",function(r){return e.CHM(t),e.oxw().goToPage(r)}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("totalResults",null==t.pagedResult?null:t.pagedResult.totalCount)("currentPage",t.page)("lastPage",null==t.pagedResult?null:t.pagedResult.pageCount)}}const te=[{path:"",redirectTo:"details",pathMatch:"full"},{path:"details",component:N},{path:"users",component:(()=>{class s extends D.bk{constructor(t,a,r,l,n,oe,ae){super(n,a,!0),this.rolesService=t,this.localize=r,this.router=l,this.errorService=oe,this.userService=ae,this.pageStream=new Z.x,this.pageSizeStream=new Z.x,this.userToRemove=null,this.removeSummaryTranslation="",this.removeSummary="",this.page=1,this.pageSize=25}ngOnInit(){this.isLoading=!0,this.rolesService.getCachedRole().pipe((0,Y.P)()).subscribe(t=>{this.role=t,this.removeSummaryTranslation=this.removeSummaryTranslation.replace("{1}",this.role.name);const a=this.pageStream.pipe((0,w.U)(n=>(this.page=n,{searchTerm:this.searchTerm,page:n,pageSize:this.pageSize}))),r=this.pageSizeStream.pipe((0,w.U)(n=>(this.pageSize=n,{searchTerm:this.searchTerm,page:this.page,pageSize:n})));a.pipe((0,u.T)(r),(0,u.T)(this.searchSource),(0,u.T)(this.enterKeySource),(0,F.O)({searchTerm:this.searchTerm,page:this.page,pageSize:this.pageSize}),(0,I.z)(n=>(this.isLoading=!0,this.rolesService.getUsersInRole(t.id,n.page,n.pageSize,n.searchTerm).pipe((0,Q.g)(200))))).subscribe(n=>{this.pagedResult=n,this.users=n.results,this.isLoading=!1},n=>{this.errorService.handleError(n),this.isLoading=!1})})}mapSearchTerm(t){return this.searchTerm=t,{searchTerm:this.searchTerm,page:1,pageSize:this.pageSize}}onSubmit(t){this.pageStream.next(1)}goToPage(t){this.pageStream.next(t)}setPageLength(t){this.page=1,this.pageSizeStream.next(t)}goToUser(t){const a=[this.localize.translateRoute("/users/view/"),t.subject,"roles"];this.router.navigate(a)}removeUser(t){this.removeSummary=this.removeSummaryTranslation.replace("{0}",t.username),this.userToRemove=t}delete(){this.isLoading=!0,this.userService.deleteUserRoles(this.userToRemove.subject,[this.role.name]).subscribe(t=>{let a=this.users&&1===this.users.length&&this.page>1?this.page-1:this.page;a<1&&(a=1),this.goToPage(a),this.toastr.success(this.translate.instant("Roles.Success"),this.translate.instant("Notifications.Success")),this.userToRemove=null},t=>{this.isLoading=!1,"401"===t.status&&this.toastr.warning(this.translate.instant("Roles.UnassignUnauthorized"),this.translate.instant("Notifications.Unauthorized")),this.userToRemove=null})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(v.f),e.Y36(c.sK),e.Y36(d.An),e.Y36(h.F0),e.Y36(j._W),e.Y36(E.T),e.Y36(K.K))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-role-users"]],features:[e.qOj],decls:14,vars:9,consts:[[1,"tw-container","tw-mx-auto"],["id","searchContainer",1,"tw-mb-2"],[1,"tw-flex","tw-bg-white","tw-border","tw-border-grey-300","tw-opacity-75","tw-cursor-text","tw-rounded","focus-within:tw-opacity-100","focus-within:tw-border-blue-400","trans"],["for","searchTerm",1,"tw-flex","tw-items-center","tw-text-grey-500","tw-m-0","tw-ml-3"],["aria-hidden","true",1,"far","fa-search","tw-text-sm"],[1,"sr-only"],["id","searchRole","type","search","minlength","2","maxlength","25","required","","autocomplete","off",1,"tw-bg-transparent","tw-border-0","tw-text-base","tw-leading-tight","tw-px-2","tw-py-2","tw-w-full","focus:tw-outline-none","trans",3,"ngModel","ngModelChange","keyup"],[4,"ngIf"],["class","tw-alert","role","alert",4,"ngIf"],["id","roleUsersTable","class","datatable selectable hover",4,"ngIf"],[3,"totalResults","currentPage","lastPage","onGoToPage",4,"ngIf"],["left","",4,"ngIf"],["left",""],[1,"tw-form-select","tw-w-auto"],["for","pageSizeToggle",1,"sr-only"],["id","pageSizeToggle",1,"tw-form-control","tw-form-control-small",3,"ngModel","ngModelChange","change"],["value","25"],["value","50"],["value","100"],["role","alert",1,"tw-alert"],["id","roleUsersTable",1,"datatable","selectable","hover"],[1,"sm:tw-w-1/3","md:tw-w-1/2"],[1,"tw-hidden","sm:tw-table-cell"],["id","usersInRoleTable"],[4,"ngFor","ngForOf"],[1,"tw-max-w-0","tw-truncate",3,"click"],[1,"tw-text-blue-500"],[1,"tw-hidden","tw-max-w-0","tw-truncate","sm:tw-table-cell",3,"click"],[3,"totalResults","currentPage","lastPage","onGoToPage"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"label",3),e._UZ(4,"span",4),e.TgZ(5,"span",5),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA(),e.TgZ(8,"input",6),e.NdJ("ngModelChange",function(l){return a.searchTerm=l})("keyup",function(l){return a.search(l)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,_,2,1,"app-action-bar",7),e.YNc(10,B,1,0,"app-simple-loader",7),e.YNc(11,X,4,3,"div",8),e.YNc(12,k,14,10,"table",9),e.YNc(13,ee,1,3,"app-pager",10),e.qZA()),2&t&&(e.xp6(6),e.Oqu(e.lcZ(7,7,"Common.Search")),e.xp6(2),e.Q6J("ngModel",a.searchTerm),e.xp6(1),e.Q6J("ngIf",!a.isLoading),e.xp6(1),e.Q6J("ngIf",a.isLoading),e.xp6(1),e.Q6J("ngIf",a.users&&0==a.users.length&&!a.isLoading),e.xp6(1),e.Q6J("ngIf",a.users&&a.users.length>0&&!a.isLoading),e.xp6(1),e.Q6J("ngIf",(null==a.pagedResult?null:a.pagedResult.results.length)>0&&!a.isLoading))},directives:[p.Fj,p.wO,p.nD,p.Q7,p.JJ,p.On,g.O5,H.K,p.EJ,p.YN,p.Kr,$.w,g.sg,G.P],pipes:[c.X$],styles:["[_nghost-%COMP%]{width:100%;display:block;position:relative}"]}),s})()}];let se=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[R.O],imports:[[g.ez,h.Bz.forChild(te),c.aw.forChild({extend:!0}),x.D,L.y,T.U,d.fQ,y.I,C.j,U.M,V.s,T.U,S.p,p.u5,A.G]]}),s})()}}]);